<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Demo Situs Slot ‚Äî Slot Machine</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#ffb347;
    --muted:#94a3b8;
    --glass: rgba(255,255,255,0.04);
    font-family: Inter, Roboto, Arial, sans-serif;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:
      radial-gradient(1200px 600px at 10% 10%, rgba(255,180,70,0.06), transparent 10%),
      radial-gradient(900px 400px at 90% 90%, rgba(90,150,255,0.03), transparent 10%),
      var(--bg);
    color:#e6eef8;
    padding:24px;
  }

  .container{
    width:100%;
    max-width:980px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
    border-radius:14px;
    padding:20px;
    box-shadow: 0 8px 30px rgba(2,6,23,0.6);
    display:grid;
    grid-template-columns: 1fr 380px;
    gap:18px;
  }

  /* Left: Slot board */
  .slot-board{
    background:var(--card);
    border-radius:12px;
    padding:18px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .top-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
  }
  .brand{font-weight:700; font-size:18px; color:var(--accent)}
  .balance{
    background:var(--glass);
    padding:8px 12px;
    border-radius:10px;
    font-size:14px;
    color:var(--muted);
  }

  .reels{
    margin-top:6px;
    display:flex;
    gap:12px;
    justify-content:center;
    align-items:center;
    padding:12px;
    border-radius:10px;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));
  }

  .reel{
    width:110px;
    height:110px;
    overflow:hidden;
    border-radius:10px;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.08));
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
    border:1px solid rgba(255,255,255,0.03);
  }

  .reel .strip{
    position:absolute;
    top:0;
    left:0;
    right:0;
    transition: transform 1s cubic-bezier(.12,.8,.25,1);
    display:flex;
    flex-direction:column;
    align-items:center;
  }

  .symbol{
    width:100%;
    height:110px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:44px;
    user-select:none;
  }

  /* Controls */
  .controls{
    display:flex;
    gap:10px;
    align-items:center;
    margin-top:8px;
  }
  .btn{
    background:linear-gradient(180deg, #1f2937, #0b1220);
    color:#fff;
    border:none;
    padding:10px 14px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
    box-shadow: 0 6px 14px rgba(2,6,23,0.6);
  }
  .btn:active{transform:translateY(1px)}
  .btn.spin{background:linear-gradient(90deg,var(--accent), #ff7a7a); color:#0b1220}

  .small-input{
    background:transparent;
    border:1px solid rgba(255,255,255,0.06);
    padding:8px 10px;
    border-radius:8px;
    color:inherit;
    width:120px;
  }

  /* Right column: info / paytable */
  .side{
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .card{
    background:var(--card);
    padding:12px;
    border-radius:10px;
  }
  .pay-table{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:8px;
  }
  .pay-item{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:8px;
    background:rgba(255,255,255,0.012);
    border-radius:8px;
    font-size:14px;
  }
  .meta{font-size:12px; color:var(--muted)}

  .message{
    min-height:40px;
    display:flex;
    align-items:center;
    gap:8px;
    font-size:14px;
    color:var(--accent);
  }

  footer{font-size:12px; color:var(--muted); text-align:center; margin-top:8px}

  @media (max-width:940px){
    .container{grid-template-columns:1fr; padding:14px}
    .side{order:2}
  }
</style>
</head>
<body>
  <div class="container" role="application" aria-label="Demo slot machine">
    <div class="slot-board" aria-live="polite">
      <div class="top-row">
        <div class="brand">SLOT DEMO ‚Ä¢ LuckySpin</div>
        <div class="balance">Kredit: <strong id="balance">1,000</strong></div>
      </div>

      <div class="reels" id="reels" aria-hidden="false">
        <!-- Three reels -->
        <div class="reel" data-reel="0">
          <div class="strip"></div>
        </div>
        <div class="reel" data-reel="1">
          <div class="strip"></div>
        </div>
        <div class="reel" data-reel="2">
          <div class="strip"></div>
        </div>
      </div>

      <div class="controls">
        <label class="meta" for="bet">Taruhan:</label>
        <input id="bet" class="small-input" type="number" min="1" step="1" value="10" />
        <button id="spinBtn" class="btn spin">SPIN</button>
        <button id="autoBtn" class="btn">AUTO</button>
        <button id="maxBtn" class="btn">MAX</button>
        <div style="flex:1"></div>
        <div class="meta">Status: <span id="status" class="message">Siap</span></div>
      </div>

      <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
        <button id="addCredits" class="btn">+ Tambah Kredit</button>
        <button id="resetBtn" class="btn">Reset</button>
      </div>

      <footer>Demo hanya untuk tujuan edukasi ‚Äî bukan platform perjudian nyata.</footer>
    </div>

    <div class="side">
      <div class="card">
        <div style="font-weight:700; margin-bottom:8px">Tabel Pembayaran</div>
        <div class="pay-table" id="paytable">
          <!-- pay items inserted by JS -->
        </div>
        <div class="meta" style="margin-top:8px">3 simbol cocok pada garis horizontal utama.</div>
      </div>

      <div class="card">
        <div style="font-weight:700; margin-bottom:8px">Simbol</div>
        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <div style="display:flex;flex-direction:column;align-items:center;width:80px">
            <div style="font-size:36px">üçí</div><div class="meta">Cherry</div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;width:80px">
            <div style="font-size:36px">üîî</div><div class="meta">Bell</div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;width:80px">
            <div style="font-size:36px">üíé</div><div class="meta">Diamond</div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;width:80px">
            <div style="font-size:36px">üçã</div><div class="meta">Lemon</div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:center;width:80px">
            <div style="font-size:36px">‚≠ê</div><div class="meta">Star (JACKPOT)</div>
          </div>
        </div>
      </div>

      <div class="card" aria-live="polite">
        <div style="font-weight:700; margin-bottom:8px">Riwayat</div>
        <div id="history" style="max-height:220px; overflow:auto; font-size:13px; color:var(--muted)"></div>
      </div>
    </div>
  </div>

<script>
/*
  Demo slot logic (client-side).
  - 3 reels, each shows three stacked symbols; central visible symbol is used for payout.
  - Symbols and weights determine distribution.
  - Simple paytable: match 3 of same symbol gets multiplier * bet.
  - Not suitable for real-money gambling without backend, security, legal compliance.
*/

// Config
const symbols = [
  { id: 'cherry', icon:'üçí', weight: 28, payout: 4 },
  { id: 'lemon',  icon:'üçã', weight: 24, payout: 3 },
  { id: 'bell',   icon:'üîî', weight: 20, payout: 6 },
  { id: 'diamond',icon:'üíé', weight: 18, payout: 10 },
  { id: 'star',   icon:'‚≠ê', weight: 10, payout: 50 } // jackpot rare
];

// Build weighted symbol list for randomness
const weighted = [];
symbols.forEach(s => {
  for(let i=0;i<s.weight;i++) weighted.push(s);
});

// State
let balance = 1000;
let autoMode = false;
const reelsEl = document.getElementById('reels');
const balanceEl = document.getElementById('balance');
const betInput = document.getElementById('bet');
const spinBtn = document.getElementById('spinBtn');
const autoBtn = document.getElementById('autoBtn');
const maxBtn = document.getElementById('maxBtn');
const statusEl = document.getElementById('status');
const historyEl = document.getElementById('history');
const addCreditsBtn = document.getElementById('addCredits');
const resetBtn = document.getElementById('resetBtn');
const paytableEl = document.getElementById('paytable');

function updateBalance(){
  balanceEl.textContent = Math.round(balance);
}
function setStatus(txt, accent=false){
  statusEl.textContent = txt;
  statusEl.style.color = accent ? 'var(--accent)' : '';
}
function appendHistory(txt){
  const d = document.createElement('div');
  d.textContent = txt;
  historyEl.prepend(d);
  // keep only recent 100
  while(historyEl.children.length > 100) historyEl.removeChild(historyEl.lastChild);
}

// render paytable
function renderPaytable(){
  paytableEl.innerHTML = '';
  symbols.slice().reverse().forEach(s => {
    const w = document.createElement('div');
    w.className='pay-item';
    w.innerHTML = `<div style="display:flex;gap:8px;align-items:center"><div style="font-size:20px">${s.icon}</div><div>${s.id}</div></div><div><strong>x${s.payout}</strong></div>`;
    paytableEl.appendChild(w);
  });
}
renderPaytable();

// populate reels visual strips with repeated symbols
function makeStripContent(){
  // each reel strip will be longer to allow animation
  return weighted.concat(weighted).concat(weighted); // repeat to reduce edge effects
}

function buildReels(){
  const stripContent = makeStripContent();
  document.querySelectorAll('.reel').forEach((reelEl, idx) => {
    const strip = reelEl.querySelector('.strip');
    strip.innerHTML = '';
    // randomize starting offset
    for(let i=0;i<stripContent.length;i++){
      const sym = stripContent[i];
      const div = document.createElement('div');
      div.className='symbol';
      div.textContent = sym.icon;
      strip.appendChild(div);
    }
    // small random transform
    strip.style.transform = `translateY(-${Math.floor(Math.random()*110)}px)`;
  });
}
buildReels();

// Spin logic
let spinning = false;
function getRandomSymbol(){
  return weighted[Math.floor(Math.random()*weighted.length)];
}
function spinOnce(){
  if(spinning) return;
  let bet = Number(betInput.value) || 1;
  if(bet <= 0) bet = 1;
  if(bet > balance){
    setStatus('Kredit tidak cukup', false);
    return;
  }

  spinning = true;
  setStatus('Berputar...', false);
  spinBtn.disabled = true;
  autoBtn.disabled = true;
  maxBtn.disabled = true;

  // Deduct bet
  balance -= bet;
  updateBalance();

  // Choose outcome symbols (center row)
  const outcome = [
    getRandomSymbol(),
    getRandomSymbol(),
    getRandomSymbol()
  ];

  // For each reel, compute target index in strip and animate
  const stripContent = makeStripContent();
  const baseDelay = 300;
  document.querySelectorAll('.reel').forEach((reelEl, idx) => {
    const strip = reelEl.querySelector('.strip');
    // find a random index in stripContent matching chosen outcome
    let targetIndexes = [];
    for(let i=0;i<stripContent.length;i++){
      if(stripContent[i].id === outcome[idx].id) targetIndexes.push(i);
    }
    let chosen = targetIndexes[Math.floor(Math.random()*targetIndexes.length)];
    // shift so that chosen symbol will land centered
    // each symbol height is 110px; center will be at translate such that chosen item is visible at top 0 (we used overflow:hidden)
    // We'll animate to a very large negative translate to create spin illusion
    const spinRounds = 3 + idx; // more rounds for later reels
    const finalIndex = chosen + spinRounds * stripContent.length;
    const translateY = finalIndex * 110;
    // Add small randomness
    const extraOffset = Math.floor(Math.random()*3) * 110;
    const totalTranslate = translateY + extraOffset;

    // set transition durations and delays for staggered stop
    const duration = 800 + idx*200 + Math.floor(Math.random()*300);
    strip.style.transition = `transform ${duration}ms cubic-bezier(.12,.8,.25,1)`;
    // start transform (must trigger in next frame)
    setTimeout(()=>{
      strip.style.transform = `translateY(-${totalTranslate}px)`;
    }, 30 + idx*80);

    // after animation done for last reel, evaluate
    const onDone = idx === 2 ? duration + baseDelay + 200 : 0;
    if(onDone){
      setTimeout(()=>{ finishSpin(outcome, bet); }, onDone);
    }
  });
}

function finishSpin(outcome, bet){
  // Determine payout: simple rule: 3 same symbols => payout multiplier
  let payout = 0;
  const ids = outcome.map(o => o.id);
  if(ids[0] === ids[1] && ids[1] === ids[2]){
    const sym = symbols.find(s=>s.id===ids[0]);
    payout = bet * sym.payout;
    balance += payout;
    setStatus(`MENANG! ${outcome[0].icon} x3 -> +${payout} kredit`, true);
    appendHistory(`${new Date().toLocaleTimeString()} ‚Ä¢ Menang: ${payout} (Taruhan ${bet})`);
  } else {
    setStatus('Kalah', false);
    appendHistory(`${new Date().toLocaleTimeString()} ‚Ä¢ Kalah (Taruhan ${bet})`);
  }

  updateBalance();
  spinning = false;
  spinBtn.disabled = false;
  autoBtn.disabled = false;
  maxBtn.disabled = false;

  // auto mode continuation
  if(autoMode){
    // stop auto if balance too low
    const betVal = Number(betInput.value) || 1;
    if(balance < betVal){
      autoMode = false;
      autoBtn.textContent = 'AUTO';
      setStatus('Auto berhenti ‚Äî kredit tidak cukup', false);
    } else {
      // small delay before next spin
      setTimeout(()=>{ if(!spinning) spinOnce(); }, 400);
    }
  }
}

// Controls
spinBtn.addEventListener('click', spinOnce);
autoBtn.addEventListener('click', ()=>{
  autoMode = !autoMode;
  autoBtn.textContent = autoMode ? 'STOP' : 'AUTO';
  if(autoMode){
    // ensure enough balance
    const betVal = Number(betInput.value) || 1;
    if(balance < betVal){
      setStatus('Kredit tidak cukup untuk auto', false);
      autoMode = false;
      autoBtn.textContent = 'AUTO';
      return;
    }
    setStatus('Auto running...', false);
    spinOnce();
  }
});

maxBtn.addEventListener('click', ()=>{
  const maxBet = Math.max(1, Math.floor(balance/10));
  betInput.value = maxBet;
  setStatus('Taruhan diset MAX', false);
});

addCreditsBtn.addEventListener('click', ()=>{
  balance += 500;
  updateBalance();
  setStatus('+500 kredit ditambahkan', true);
  appendHistory(`${new Date().toLocaleTimeString()} ‚Ä¢ +500 kredit`);
});

resetBtn.addEventListener('click', ()=>{
  balance = 1000;
  updateBalance();
  betInput.value = 10;
  historyEl.innerHTML='';
  setStatus('Reset ke kondisi awal', false);
});

// Initialize UI
updateBalance();
setStatus('Siap', false);

// Accessibility: allow Space to spin when focused on page
window.addEventListener('keydown', (e)=>{
  if(e.code === 'Space' && document.activeElement.tagName !== 'INPUT'){
    e.preventDefault();
    spinOnce();
  }
});
</script>
</body>
</html>
